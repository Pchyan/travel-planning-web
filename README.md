# 旅遊規劃助手 - 離線支援功能

## 功能概述

旅遊規劃助手現已加入完整的離線支援功能，讓使用者即使在網絡不穩定或完全離線的環境下也能繼續使用主要功能。

### 主要離線功能

1. **離線瀏覽和編輯行程**
   - 在離線狀態下瀏覽已保存的行程
   - 添加、刪除和重新排序景點
   - 修改行程設置

2. **自動同步機制**
   - 離線狀態下的修改會記錄在本地
   - 網絡恢復後自動同步所有修改
   - 提供同步狀態指示器和手動同步選項

3. **可安裝的PWA應用**
   - 支持安裝為本地應用程序
   - 提供完整的離線體驗
   - 更快的啟動和更好的性能

## 技術實現

### Service Worker

應用使用Service Worker實現資源緩存和離線訪問：

```javascript
// service-worker.js
// 緩存靜態資源，使用網絡優先策略處理API請求
// 離線時提供基本功能和適當的用戶提示
```

### 同步隊列

離線更改通過同步隊列進行管理：

```javascript
// 將操作添加到同步隊列
function addToSyncQueue(operationType, operationData) {
    // 創建操作記錄並儲存到本地
}

// 網絡恢復後嘗試同步
function attemptSync() {
    // 處理待同步的操作
}
```

### 用戶界面

提供清晰的離線狀態指示：

- 頂部狀態指示器顯示當前網絡狀態
- 離線模式下的操作有明確標記
- 同步狀態和進度提示

## 使用指南

### 離線操作

1. 當網絡連接中斷時，頂部會顯示「離線模式」指示器
2. 所有在離線狀態下的更改都會自動保存到本地
3. 可通過點擊「離線狀態」鏈接查看待同步項目

### 同步數據

1. 恢復網絡連接後，系統會自動嘗試同步
2. 點擊「立即同步」可手動觸發同步操作
3. 同步完成後會顯示成功/失敗數量的提示

### 安裝為本地應用

1. 首次訪問時會顯示安裝提示
2. 點擊「安裝」按鈕將應用添加到主屏幕
3. 安裝後可離線使用全部核心功能

## 注意事項

- 離線時添加的新景點如無法地理編碼，會使用默認座標，並在網絡恢復後自動更新
- 所有離線修改會在本地保存，不會丟失
- 如遇同步問題，可嘗試手動同步或刷新頁面 